@model DataAccessLayer.ViewModels.MenuViewModel
<div class="container-fluid p-3 " style="height: 700px;">
    <div class="row">
        <div class="col-2 ">
            <div class="row d-none d-xl-flex flex-column">
                <div class="">
                    <span class="h4 fw-bold " style="color: #0066A7;">Modifier Group
                        <button type="button" data-bs-toggle="modal" data-bs-target="#addmodifer"
                            style="text-decoration: none; border: none; background-color: white;"><i
                                class="bi bi-plus-square ms-2 h5"></i>
                        </button>

                    </span>
                </div>
                <div class="modifier overflow-auto mt-3">
                    @foreach (var modifier in Model.ModifierGroupModel)
                    {
                        <a class="justify-content-start align-items-center modifier-inner-box mt-2 text-reset"
                            style="text-decoration: none;" href="javascript:void(0);"
                            onclick="LoadPartialModifierView(@modifier.ModifierGroupId)">

                            <div class="mb-3 name-sidebar ms-1 active-name" id="modifier-container">
                                <img src="~/images/logos/sixdot.png" alt="" style="width:20px; height: 15px;"
                                    class="active-icon">
                                @modifier.ModifierGroupName
                                <a class="editButtom" href="javascript:void(0);" style="text-decoration: none; color: grey;"
                                    id="editModifier" onclick="openEditModifierModal(@modifier.ModifierGroupId)">
                                    <i class="bi bi-pen float-end"></i>
                                </a>
                                <a class="deleteButton" href="javascript:void(0);"
                                    style="text-decoration: none; color: grey;"
                                    onclick="openModifierGroupDeleteModal(@modifier.ModifierGroupId)">
                                    <i class="bi bi-trash float-end"></i>
                                </a>


                            </div>
                        </a>
                    }

                </div>

            </div>

            <!-- Model Add Modifier -->

            @* <form method="post" asp-action="AddModifierGroup" asp-controller="Menu">
                <div class="modal fade" id="addmodifer" data-bs-backdrop="static" data-bs-keyboard="false"
                    tabindex="-1" aria-labelledby="staticBackdropLabel" aria-hidden="true" >
                    <div class="modal-dialog modal-dialog-centered">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h1 class="modal-title fs-5" id="staticBackdropLabel">Add
                                    Modifier Group</h1>
                                <button type="button" class="btn-close" data-bs-dismiss="modal"
                                    aria-label="Close"></button>
                            </div>
                            <div class="modal-body">
                                <input type="hidden" id="Modifiersgroupid" name="Modifiersgroupid"> 
                                <div class="form-floating mb-3">
                                    <input type="text" class="form-control" id="Modifiersgroupname" name="Modifiersgroupname"
                                        placeholder="Category Name" required>
                                    <label for="Modifiersgroupname">Name</label>
                                </div>
                                <div class="form-floating">
                                    <textarea class="form-control" name="Modifiersgroupdescription" id="Modifiersgroupdescription"
                                        placeholder="Enter Description"></textarea>
                                    <label for="Modifiersgroupdescription">Description</label>
                                </div>
                                <div class="mt-3" >
                                    <a href="">+ Add Existing Modifier</a>
                                </div>
                                <div class="col mt-3 mb-3 d-flex justify-content-end">
                                    <button class="btn text-white me-2" style="background-color: #0066A7;"
                                        type="submit">Save</button>
                                    <button class="btn" style="border-color: #0066A7; color: #0066A7;" type="button"
                                        data-bs-dismiss="modal">Cancel</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </form> *@
            @* <form method="post" asp-action="AddModifierGroup" asp-controller="Menu">
                <div class="modal fade" id="addmodifer" aria-hidden="true" tabindex="-1">
                    <div class="modal-dialog modal-dialog-centered">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h1 class="modal-title fs-5" id="modalTitle">Add Modifier Group</h1>
                                <button type="button" class="btn-close" data-bs-dismiss="modal"
                                    aria-label="Close"></button>
                            </div>
                            <div class="modal-body">
                                <input type="hidden" id="Modifiersgroupid" name="Modifiersgroupid">
                                <div class="form-floating mb-3">
                                    <input type="text" class="form-control" id="Modifiersgroupname"
                                        name="Modifiersgroupname" placeholder="Category Name" required>
                                    <label for="Modifiersgroupname">Name</label>
                                </div>
                                <div class="form-floating">
                                    <textarea class="form-control" name="Modifiersgroupdescription"
                                        id="Modifiersgroupdescription" placeholder="Enter Description"></textarea>
                                    <label for="Modifiersgroupdescription">Description</label>
                                </div>
                                <div class="mt-3">
                                    <a href="#" id="showTable" data-bs-target="#exampleModalToggle2"
                                        data-bs-toggle="modal" data-bs-dismiss="modal">+ Add Existing Modifier</a>
                                </div>
                                <div class="col mt-3 mb-3 d-flex justify-content-end">
                                    <button class="btn text-white me-2" style="background-color: #0066A7;"
                                        type="submit">Save</button>
                                    <button class="btn" style="border-color: #0066A7; color: #0066A7;" type="button"
                                        data-bs-dismiss="modal">Cancel</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </form>

            <div class="modal fade" id="exampleModalToggle2" aria-hidden="true" tabindex="-1">
                <div class="modal-dialog modal-dialog-centered">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h1 class="modal-title fs-5" id="modalTitle">Select Existing Modifier </h1>
                            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                        </div>
                        <div class="modal-body">
                            <div class="table-responsive">
                                <table class="table">
                                    <thead>
                                        <tr>
                                            <th scope="col"><input class="form-check-input main-check" type="checkbox"
                                                    value="" id="selectAllCheckbox"></th>
                                            <th scope="col">Name</th>
                                            <th scope="col">Unit</th>
                                            <th scope="col">Rate</th>
                                            <th scope="col">Quantity</th>

                                        </tr>
                                    </thead>
                                    <tbody id="itemsTableBody">
                                        @foreach (var item in Model.ModifierItemAll)
                                        {
                                            <tr>
                                                <td>
                                                    <input class="form-check-input inner-check" type="checkbox"
                                                        data-id="@item.ModifierItemId">
                                                </td>
                                                <td>@item.ModifierItemName</td>
                                                <td>@item.ModifierUnitname</td>
                                                <td>@item.Rate</td>
                                                <td>@item.Quantity</td>

                                            </tr>
                                        }
                                    </tbody>
                                </table>
                            </div>
                            <div class="main-pagination  ">
                                <div class="item-show ">
                                    <nav aria-label="Page navigation example">
                                        <div class="pagination ">
                                            <span class="align-self-center">Items Per Page
                                                :</span>
                                            <select class="form-select form-select-sm ms-2 align-self-center"
                                                aria-label="Small select example" style=" width: unset; ">
                                                <option value="1">1</option>
                                                <option value="2">2</option>
                                                <option value="3">3</option>
                                            </select>
                                        </div>
                                    </nav>
                                </div>
                                <div class="showing-page">
                                    <nav aria-label="Page navigation example">
                                        <div class="pagination ">
                                            <span class=" ms-2  align-self-center">Showing 1-5
                                                of 13</span>
                                            <button class="btn border ms-2  align-self-center" type="submit"><i
                                                    class="bi bi-chevron-left "></i>
                                            </button>
                                            <button class="btn border ms-2  align-self-center" type="submit"><i
                                                    class="bi bi-chevron-right"></i>
                                            </button>
                                        </div>
                                    </nav>
                                </div>
                            </div>
                            <!-- Back Button -->
                            <div class="d-flex justify-content-end mt-3">

                                <button type="submit" class="btn text-white" style="background-color: #0066A7;">
                                    Add </button>
                                <button class="btn" id="backToForm" data-bs-dismiss="modal"
                                    style="border-color: #0066A7; color: #0066A7; text-decoration: none;">Back</button>
                            </div>

                        </div>
                    </div>
                </div>
            </div> *@
<form method="post" asp-action="AddModifierGroup" asp-controller="Menu">
                <div class="modal fade" id="addmodifer" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1"
                    aria-labelledby="staticBackdropLabel" aria-hidden="true">
                    <div class="modal-dialog modal-dialog-centered modal-lg">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h1 class="modal-title fs-5" id="modalTitle">Add Modifier Group</h1>
                                <button type="button" class="btn-close" data-bs-dismiss="modal"
                                    aria-label="Close"></button>
                            </div>
                            <div class="modal-body">
                                <!-- Form Section -->
                                <div id="formSection">
                                    <input type="hidden" id="Modifiersgroupid" name="Modifiersgroupid">
                                    <div class="form-floating mb-3">
                                        <input type="text" class="form-control" id="Modifiersgroupname"
                                            name="Modifiersgroupname" placeholder="Category Name" required>
                                        <label for="Modifiersgroupname">Name</label>
                                    </div>
                                    <div class="form-floating">
                                        <textarea class="form-control" name="Modifiersgroupdescription"
                                            id="Modifiersgroupdescription" placeholder="Enter Description"></textarea>
                                        <label for="Modifiersgroupdescription">Description</label>
                                    </div>
                                    <div class="mt-3">
                                        <a href="#" id="showTable">+ Add Existing Modifier</a>
                                    </div>
                                    <div class="col mt-3 mb-3 d-flex justify-content-end">
                                        <button class="btn text-white me-2" style="background-color: #0066A7;"
                                            type="submit">Save</button>
                                        <button class="btn" style="border-color: #0066A7; color: #0066A7;" type="button"
                                            data-bs-dismiss="modal">Cancel</button>
                                    </div>
                                </div>

                                <!-- Table Section (Hidden Initially) -->
                                <div id="tableSection" style="display: none;">
                                    <div class="table-responsive">
                                        <table class="table">
                                            <thead>
                                                <tr>
                                                    <th scope="col"><input class="form-check-input main-check"
                                                            type="checkbox" value="" id="selectAllCheckbox"></th>
                                                    <th scope="col">Name</th>
                                                    <th scope="col">Unit</th>
                                                    <th scope="col">Rate</th>
                                                    <th scope="col">Quantity</th>
                                                    <th scope="col">Action</th>
                                                </tr>
                                            </thead>
                                            <tbody id="itemsTableBody">
                                                @foreach (var item in Model.ModifierItemAll)
                                                {
                                                    <tr>
                                                        <td>
                                                            <input class="form-check-input inner-check" type="checkbox"
                                                                data-id="@item.ModifierItemId">
                                                        </td>
                                                        <td>@item.ModifierItemName</td>
                                                        <td>@item.ModifierUnitname</td>
                                                        <td>@item.Rate</td>
                                                        <td>@item.Quantity</td>
                                                        <td>
                                                            <div class="d-flex">
                                                                <a href="#" style="text-decoration: none; color: grey;"
                                                                    data-bs-toggle="modal" data-bs-target="#edititemModal"
                                                                    onclick="GetItemDetails(@item.ModifierItemId)">
                                                                    <i class="bi bi-pen"></i>
                                                                </a>
                                                                <a href="#" class="ms-4"
                                                                    style="text-decoration: none; color: grey;"
                                                                    data-bs-toggle="modal" data-bs-target="#itemdeleteModal"
                                                                    onclick="openItemDeleteModal(@item.ModifierItemId)"><i
                                                                        class="bi bi-trash"></i></a>
                                                            </div>
                                                        </td>
                                                    </tr>
                                                }
                                            </tbody>
                                        </table>
                                    </div>
                                    <!-- Back Button -->
                                    <div class="d-flex justify-content-end mt-3">
                                        <button class="btn btn-secondary" id="backToForm">Back</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </form>



            <!-- Model Edit Modifier -->
            <form method="post" asp-action="UpdateModififerGroup" asp-controller="Menu">

                <div class="modal fade" id="editmodifiermodel" data-bs-backdrop="static" data-bs-keyboard="false"
                    tabindex="-1" aria-labelledby="staticBackdropLabel" aria-hidden="true">
                    <div class="modal-dialog modal-dialog-centered">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h1 class="modal-title fs-5">Edit Category</h1>
                                <button type="button" class="btn-close" data-bs-dismiss="modal"
                                    aria-label="Close"></button>
                            </div>
                            <div class="modal-body">
                                <input type="hidden" id="editModifierId" name="ModifierGroupId">

                                <div class="form-floating mb-3">
                                    <input type="text" class="form-control" id="editModifierName"
                                        name="ModifierGroupName" placeholder="Category Name" required>
                                    <label for="editModifierName">Name</label>
                                </div>
                                <div class="form-floating">
                                    <textarea class="form-control" name="ModifierGroupDescription"
                                        id="editModifierDescription" placeholder="Enter Description"></textarea>
                                    <label for="editModifierDescription">Description</label>
                                </div>
                                <div class="col mt-3 mb-3 d-flex justify-content-end">
                                    <button class="btn text-white me-2" style="background-color: #0066A7;"
                                        type="submit">Save</button>
                                    <button class="btn" style="border-color: #0066A7; color: #0066A7;" type="button"
                                        data-bs-dismiss="modal">Cancel</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </form>

            <!-- Model Delete -->
            <div class="modal fade" id="deleteModifierGroupModal" data-bs-backdrop="static" data-bs-keyboard="false"
                tabindex="-1" aria-labelledby="staticBackdropLabel" aria-hidden="true">
                <div class="modal-dialog modal-dialog-centered">
                    <div class="modal-content">
                        <div class="modal-body">
                            <div class="d-flex justify-content-center">
                                <img src="~/images/toppng.com-warning-icon-2400x2400.png" alt=""
                                    style="width: 10%; height: 10%;">
                            </div>
                            <div class="d-flex justify-content-center mt-3">
                                <span class="text-muted">Are you sure you want to delete this Category?</span>
                            </div>
                            <div class="d-flex justify-content-center mt-3">
                                <button class="btn text-white" style="background-color: #0066A7;" type="button"
                                    id="confirmModifierGroupDelete">Yes</button>
                                <button class="btn ms-2" style="border-color: #0066A7; color: #0066A7;" type="button"
                                    data-bs-dismiss="modal">No</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="col-xl-10" id="modifierContainer">
            <partial name="_PartialModifier.cshtml" , model="Model"></partial>
        </div>
    </div>
</div>

<script>
    document.addEventListener("DOMContentLoaded", function () {
        document.getElementById("showTable").addEventListener("click", function (e) {
            e.preventDefault();
            document.getElementById("formSection").style.display = "none";
            document.getElementById("tableSection").style.display = "block";
            document.getElementById("modalTitle").innerText = "Select Modifier Items";
        });
        document.getElementById("backToForm").addEventListener("click", function () {
            document.getElementById("formSection").style.display = "block";
            document.getElementById("tableSection").style.display = "none";
            document.getElementById("modalTitle").innerText = "Add Modifier Group";
        });
        //For the Close Button 
        var modalElement = document.getElementById('addmodifer');
        modalElement.addEventListener('hidden.bs.modal', function () {
            document.getElementById("formSection").style.display = "block";
            document.getElementById("tableSection").style.display = "none";
            document.getElementById("modalTitle").innerText = "Add Modifier Group";
        });
    });

    @* 
        $(document).ready(function () {
            $('.btn-close').on('click', function () {
                $('.modal').modal('hide');  // Hide all modals
                $('.modal-backdrop').remove(); // Remove any remaining backdrop
            });
        }); *@


        function LoadPartialModifierView(modifierGroupId) {
            console.log("Category ID:", modifierGroupId);

            // Show loading animation
            $("#modifierContainer").html("<p>Loading...</p>");

            $.ajax({
                url: '@Url.Action("GetModifierItemsByModifierGroup", "Menu")',
                type: 'GET',
                data: { modifiergroupid: modifierGroupId },
                success: function (data) {
                    console.log('Partial view loaded successfully:', data);
                    $("#modifierContainer").html(data);
                },
                error: function (error) {
                    console.error('Error loading partial view:', error);
                    $("#modifierContainer").html("<p>Error loading items.</p>");
                }
            });
        }



</script>